# (PART\*) Lab 7 {-}

# Lab 7: Intro to R & Shiny Apps {-}

*Last updated `r Sys.Date()`*

This lab will have you putting into practice through visualizations and data tables much of what was covered in Lab 2B. 

# Data Tables & Figures {-}

Before we tackle data visualization and analysis, we should talk about data presentation conventions.

The UBCO Biology faculty has a [Procedures and Guidelines document](https://ubco-biology.github.io/Procedures-and-Guidelines/figures-tables.html) outlining conventions for data presentation based on current \"best practices\" in Biology. Keep in mind that you may encounter small differences when working with data or reading the results of research from other disciplines. That being said, the aim of these conventions is to achieve consistency among faculty, instructors, and students in how data are summarized and presented within lab reports and research papers.

Before continuing through this lab, please take some time individually or with your groups to read sections [5.1](https://ubco-biology.github.io/Procedures-and-Guidelines/tables.html), [5.2](https://ubco-biology.github.io/Procedures-and-Guidelines/descriptive-summary-statistics.html), and [5.4](https://ubco-biology.github.io/Procedures-and-Guidelines/figures.html) of the [UBCO Biology Procedures and Guidelines document](https://ubco-biology.github.io/Procedures-and-Guidelines/figures-tables.html). For this lab\'s assignment and all future assignments in this course, you wil be expected to follow these guidelines!

# Intro to R {-}

Visualizing data is a key part of science communication. Until now, it is likely that you\'ve used or interacted with visualizations built using tools like Excel. In Biology, it is increasingly common to not use Excel, but instead to use an application, or programming language, called R.

R offers several advantages when it comes to building visualizations. R is what we call a scripted progamming language. When we use scripts to manage our data and create visualizations, we\'re engaging in reproducible workflows, specifically computationally reproducible workflows.

# Computational reproducibility {-}

What is computational reproducibility?

When you load data into an application like Excel, you click through a series of options to clean up or organize and then visualize your data. If you wanted to repeat this process, you would have to manually go through the same series of steps over and over again, which is a lot of mouse clicking. It\'s also very difficult to communicate your workflow from raw data to visualization as you would have to write down every step and do so in a way that was clear enough for someone else to reproduce exactly.

Working in a scripted programming language like R, instead of clicking buttons, we write code that tells the program how to clean, organize, and then visualize our data. When we want to repeat the process, we just run our script - or mini program - and it exactly, computationally, reproduces our workflow. It\'s less work for us and it\'s reproducible. And, since anyone we share our script with can read our script to see the steps taken to go from raw data to visualization, it\'s transparent. We just don\'t get this level of reproducibility and transparency with Excel.

# Shiny Apps {-}

In BIOL 116 we\'re not going to learn how to write R, we\'ll save that for later. What we are going to do is start working with learning to visualize data in an application built in R called Shiny Apps. Shiny Apps allow a user to interactively visualize a data set. It will also show you the R code that is running in the background to build the visualization. This will be your first window into R.

In this lab, we\'ll work with a couple of data sets that are preloaded into the Shiny App, so you can explore mapping different variables to a visual space.

The first is a data set about penguins, called `palmerpenguins`. From the authors: \"The `palmerpenguins` data contains size measurements for three penguin species observed on three islands in the Palmer Archipelago, Antarctica.\" [Read more about the `palmerpenguins` data set](https://www.rdocumentation.org/packages/palmerpenguins/versions/0.1.0) here if you\'d like.

The second is about cars, called `mtcars`. From the authors: \"The data was extracted from the 1974 *Motor Trend* US magazine, and comprises fuel consumption and 10 aspects of automobile design and performance for 32 automobiles (1973–74 models).\" [Read more about the `mtcars` data set](https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/mtcars.html) here if you\'d like.

# Getting Started {-}

The Shiny App that we\'ll be using [can be found at this link](https://openscience.ok.ubc.ca/shiny/BIOL-116/).

The following is a descriptive overview of what you\'ll find in the two panes of the application.

## Left Pane {-}

On the left navigation you have four menu options: Welcome; Upload Data; Plot; Descriptive Stats; Analysis.

### Welcome {-}

This is an overview of the app itself.

### Upload Data {-}

For now, ignore the option to upload your own data. Instead, use either the `palmerpenguins` data or the `mtcars` data, selected from the drop down menu in the Plot menu. In **Lab 9**, you\'ll upload your own data set from your experimental research project to build visualizations for your report.

### Plot {-}

Here we select the variables we\'d like to visualize.

You\'ll want to first select a dataset, `penguins` or `mtcars`, and then select an `x` and a `y` variable from the drop down menus. Lastly, tell the Shiny App if your variable is `quantitative` or `categorical`. In Lab 2 we learned about each of these variable types, but here is a brief refresher:

**Quantitative**, or numeric, data may be either discrete or continuous.

* Discrete quantitative data are whole integers - population numbers are a good example of this, as we can\'t have half a person! 
* Continuous quantitative data on the other hand are data that lies on a continuum - an example is temperature, where there are infinite potential temperatures between 25 and 26 degrees Celsius, but our data collection tool or convention determines to what decimal point we\'ll record a given temperature. 

**Categorical** data, per its name, deals with categories of things and may be either nominal or ordinal. 

* Ordinal categorical data has an intrinsic order where one thing is more or less than another - storm severity is often classified by stages - Stage 1, Stage 2 … Stage 5 - where Stage 1 is less severe than stage 5. We don\'t know how much more severe one stage is than the next - that is we can\'t quantify the difference - but we know there is an intrinsic order.
* Nominal categorical data has no natural order - the ordering of the colours blue, pink, or white makes no difference to the data or analysis.

Once you\'ve selected your data sources and identified the data types you\'re working with, you\'ll be presented with a series of plotting options. You may also be presented with the option to group one of your variables. You will also be presented with the option to save a copy of your plot.

### Descriptive Stats {-}

Here you can run basic descriptive stats on the data that you\'ve plotted.

Similar to the instructions under the Plot tab, here, you must first select a dataset, `penguins` or `mtcars`, and then select two variables from the drop down menus, `Variable 1` and `Variable 2`. Again, you\'ll need to tell the Shiny App whether each of these variables are `quantitative` or `categorical`. 

Once you\'ve made your selections, the Shiny App will automatically calculated the preferred descriptive statistics for the type of variables you have selected. For example, if you choose 

* **two quantitative variables**, the Shiny App will provide you with the sample size `n`, mean, standard deviation `sd`, median, and inter-quartile range `iqr`.
* **one categorical and one quantitative variable**, you will be provided with the sample size `n`, mean, standard deviation `sd`, median, and inter-quartile range `iqr` for each group of your categorical variable.
* **two categorical variables**, then a frequency table will be displayed showing you how many subjects fall into each group.

### Analysis {-}

Here is where you will perform statistical tests using your selected data. The type of test performed by the Shiny App depends on the type of variables you select. 

* **T-test**: This analysis is used when examining a single quantitative (numeric) response variable in relation to a single categorical variable that has only 2 groups.
  * When performing a T-test in this app, you will be asked for a few additional parameters.
  * Type in the confidence level you would like to use for the T-test. For example, if you\'d like a 95% confidence interval, type in 0.95.
  * One assumption of the T-test is that the variance for each sample is approximately equal. However, the t-test used by this app (Welch\'s t-test) is somewhat robust to deviations in this assumption. For now, we will assume that both of your samples have equal variance. As such, please select \'Yes\' when prompted for this option.
* **ANOVA**: This analysis is used when examining a single quantitative (numeric) response variable in relation to a single categorical variable that has more than 2 groups.
* **Fisher\'s Exact Test**: This analysis is used when testing for an association between two categorical variables. It is only used when both categorical variables have exactly 2 levels/groups. For example, if one variable is sex (male/female) and the other is survival (yes/no).
* **Chi-Squared Contingency Analysis**: This analysis is used when testing for an association between two categorical variables. It is only used when at least one of the categorical variables has more than 2 levels/groups. For example, if one variable is flower colour (pink/red/white) and the other is season (spring/summer/winter/fall).

Once you\'ve conducted a statistical test, the Shiny App will provide you with instructions for \'Interpreting the Output\'. For this course, the main output of interest is the p-value. Recall from Lab 2 that if the p-value is less than our pre-determined significance level, there is a significant relationship between the variables. However, if the p-value is less than the significance level, the relationship between the variables is insignificant.  

## Right Pane {-}

Under each menu option (i.e. Plot), the right pane displays three sections: Instructions; Output; Source Code

### Instructions {-}

This green box shows detailed instructions for how to use that specific page. For example, under the `Plot` menu option, there are detailed instructions for how to create, visualize, and save your plot.

### Output {-}

This blue box shows the output that the Shiny App creates based on your selections. For example, under the `Plot` menu option, this box will show the plot you created.

### Source Code {-}

This orange box shows the script used by R to generate the output. If there are any packages that need to be loaded in order to run the script, they are shown within the `library()` function at the beginning of the script. You don\'t need to worry about doing anything with this part for now. Rather, the script is included to enhance the transparency and computational reproducibility of your analysis. For example, since you know the script used to create your plots, calculate descriptive statistics, and perform statistical analysis; if you or someone else wanted to reproduce your methods, they could load your data, copy this script into R, and re-run everything exactly as shown in the Shiny App. 

# Screencast Demo {-}

The following is a brief screencast introduction to using the Shiny App with the included datasets.

[![](https://i9.ytimg.com/vi/8WBR-0rjTv8/mq2.jpg?sqp=CKDXjooG&rs=AOn4CLA9RsWTfJM43wTfKq50qA-nBjsVzQ)](https://youtu.be/8WBR-0rjTv8)

# Activity {-}

This is your opportunity to play around with several different data types, visualizations and descriptive statistical summaries. The assignment will ask that you submit a couple of examples of both data visualizations and tables, all properly formatted according to [Section 5 of the UBCO Biology Procedures and Guidelines document](https://ubco-biology.github.io/Procedures-and-Guidelines/figures-tables.html).


# Lab 7 Assignment {-}

Please use the following template for this assignment:

[20210810_Lab7_Shiny-App-Visualization_Assignment_V1.docx](files/20210810_Lab7_Shiny-App-Visualization_Assignment_V1.docx) (22 KB)

# Lab 7 Rubric {-}

**Question 1** 

1 mark for correct figure based on types of variable inputs.  

* Two categorical variables = mosaic or barplot 
* Two numeric variables = scatterplot 
* One numeric and one categorical variable = stripchart (if < 20 observations in each group), boxplot (if > 20 observations in each group) 

1 mark for figure caption that follows guidelines. At a minimum a caption: 

* is located below the figure (0.25 marks) 
* includes a figure number (0.25 marks) 
* describes both variables (0.25 marks) 
* includes sample sizes (0.25 marks) 

**Question 2** 

4 marks for a correctly formatted table. 

* Correct values in the table (1 mark) 
* Correct descriptive statistics were used for each variable type (1 mark) 
* The heading is informative (1 mark) 
* Sample sizes and units are always included (1 mark) 

**Question 3** 

For each scenario (4 marks total): 

* 1 mark for correct p-value 
* 1 mark for correctly determining significance (or lack thereof) based on p-value 